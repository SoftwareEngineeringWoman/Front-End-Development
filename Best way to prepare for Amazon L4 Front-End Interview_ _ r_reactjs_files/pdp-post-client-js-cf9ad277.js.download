import{_ as t,e,b_ as s,a_ as i,x as o,c as n,n as a,t as r,s as l,a2 as d,d as c,Z as u,f as h,E as p}from"./shell-cc43a7af.js";import"./shreddit-post-flair-f78bee10.js";import"./faceplate-progress-3c1f8826.js";import"./follow-button-b3f5538c.js";import"./mod-note-overflow-menu-800be6cd.js";import{B as m}from"./base-translator-eacf7a73.js";import{a as f}from"./i18n-8e288ca1.js";import{I as b}from"./icon-left-outline-0aa3c81d.js";import{I as v}from"./icon-right-outline-3742f14a.js";import{H as y}from"./icon-back-outline-f7fb15a3.js";import"./icon-delete-outline-376be535.js";import"./icon-overflow-horizontal-outline-d8f18c3e.js";let g=class extends m{constructor(){super(),this.translatorChildrenName="shreddit-post",this.checkForTranslationError=t=>{window.setTimeout((()=>{document.querySelector("#post-translation-error")&&(t.isPostTranslated=!t.isPostTranslated)}),300)},this._partialRequest=new s(this)}onTranslationsEnabled(){this.togglePostTranslations(!0)}onTranslationsDisabled(){this.togglePostTranslations(!1)}findTranslatablePost(t){const e=this.querySelector(this.translatorChildrenName);if(e&&this.shouldTranslateChild(e,t))return e}async togglePostTranslations(t){const e=this.findTranslatablePost(t);if(!e)return;if(e.isTranslationFetched)return void(e.isPostTranslated=t);const s=await this.loadPostTranslations(e,t);s&&this.appendResponseToPost(e,s)}async loadPostTranslations(t,e){const s=`/svc/shreddit/translated-post/${e?f.GetTranslation:f.GetOriginal}/${t.id}`;return(await this._partialRequest.request(s))?.text()}appendResponseToPost(t,e){const s=i(e),o=t.isPostTranslated?["title","text-body"]:["title-translated","text-body-translated"];s.forEach((e=>{const s=e.getAttribute("slot")||"";o.includes(s)&&!t.querySelector(`[slot="${s}"]`)&&t.appendChild(e)})),t.isTranslationFetched=!0,this.translationContextValue.isTranslationActive?t.isPostTranslated=!0:t.isPostTranslated=!1}shouldTranslateChild(t,e){const{isPostTranslated:s,isTranslatable:i}=t;if(!i)return!1;return!s&&e||s&&!e}render(){return o`<div>\n <slot></slot>\n </div>`}};g=t([e("post-translator")],g);let k=class extends l{constructor(){super(...arguments),this.isSetup=!1,this.hasPrevious=!1,this.hasNext=!1,this.feedData=[],this.currentIndex=-1,this.setup=()=>{const t=Array.from(document.querySelectorAll("[slot=mod-queue-feed] mod-queue-list-item, [slot=mod-queue-feed] shreddit-post, [slot=mod-queue-feed] shreddit-profile-comment")).map((t=>t.getAttribute("comment-id")||t.getAttribute("id"))).filter(Boolean);t.length>0&&(this.feedData=t,this.currentIndex=this.feedData.findIndex((t=>t===this.thingId)),this.hasPrevious=this.currentIndex>0,this.hasNext=this.currentIndex+1<this.feedData.length,this.isSetup=!0)},this.handlePreviousBtnClick=()=>{const t=this.feedData[this.currentIndex-1];document.querySelector(`[slot=mod-queue-feed] mod-queue-list-item[id="${t}"] a[slot=full-post-link], [slot=mod-queue-feed] shreddit-post[id="${t}"] a[slot=full-post-link], [slot=mod-queue-feed] shreddit-profile-comment[comment-id="${t}"] *`)?.click()},this.handleNextBtnClick=()=>{const t=this.feedData[this.currentIndex+1];document.querySelector(`[slot=mod-queue-feed] mod-queue-list-item[id="${t}"] a[slot=full-post-link], [slot=mod-queue-feed] shreddit-post[id="${t}"] a[slot=full-post-link], [slot=mod-queue-feed] shreddit-profile-comment[comment-id="${t}"] *`)?.click()}}connectedCallback(){super.connectedCallback(),this.setup()}render(){return this.isSetup?o`<div>\n ${c({appearance:"plain",attributes:{type:"button","aria-label":"Previous post",disabled:!this.hasPrevious,onclick:this.handlePreviousBtnClick},leadingIcon:b({size:u.Small}),size:h.Small})}\n ${c({appearance:"plain",attributes:{type:"button","data-label":"pdp-post-close","aria-label":"Next post",disabled:!this.hasNext,onclick:this.handleNextBtnClick},leadingIcon:v({size:u.Small}),size:h.Small})}\n </div>`:d}};k.styles=[n],t([a({type:String,attribute:"thing-id"})],k.prototype,"thingId",void 0),t([r()],k.prototype,"isSetup",void 0),t([r()],k.prototype,"hasPrevious",void 0),t([r()],k.prototype,"hasNext",void 0),t([r()],k.prototype,"feedData",void 0),t([r()],k.prototype,"currentIndex",void 0),k=t([e("mod-queue-pdp-pagination-buttons")],k);let x=class extends l{constructor(){super(...arguments),this._windowEvents=new p(this,(()=>window)),this.handleBackClick=()=>{if(void 0===window.navigation)return void history.back();const t=window.navigation.currentEntry?.index;if(void 0!==t){const e=this.postId?.replace("t3_","");for(let s=t-1;s>=0;s--){const t=window.navigation.entries()[s];if(e&&t?.url?.includes(window.location.host)&&!t.url.includes(e))return void window.navigation.traverseTo(t.key)}}const e=this.subredditPrefixedName?`/${this.subredditPrefixedName}/`:"/";window.navigation.navigate(e)},this.handleEscKey=this._windowEvents.define("keydown",(t=>{"Escape"===t.key&&this.handleBackClick()}))}render(){const t="Back";return o`\n ${c({appearance:"secondary",attributes:{type:"button","aria-label":t,onclick:this.handleBackClick},size:h.Medium,screenReaderContent:t,leadingIcon:y({size:u.Medium})})}\n `}};x.styles=[n],t([a({attribute:"subreddit-prefixed-name"})],x.prototype,"subredditPrefixedName",void 0),t([a({attribute:"post-id"})],x.prototype,"postId",void 0),x=t([e("pdp-back-button")],x);let w=class extends l{constructor(){super(...arguments),this.isVisible=!1,this.handleScroll=t=>{const e=t.target.scrollTop;this.isVisible=e>60}}connectedCallback(){super.connectedCallback();this.closest('[slot="pdp-panel"]')?.addEventListener("scroll",this.handleScroll)}disconnectedCallback(){super.disconnectedCallback();this.closest('[slot="pdp-panel"]')?.removeEventListener("scroll",this.handleScroll)}render(){return this.isVisible?o`<div \n class="bg-neutral-background z-[1] flex justify-end absolute right-md shadow-md p-2xs rounded-full mt-sm" \n>\n <slot name="pagination"></slot>\n <slot name="close"></slot>\n </div>`:d}};w.styles=[n],t([r()],w.prototype,"isVisible",void 0),w=t([e("mod-queue-pdp-floating-ctas")],w);
//# sourceMappingURL=pdp-post-client-js-cf9ad277.js.map
